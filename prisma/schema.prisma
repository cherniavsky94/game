generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  username  String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  characters Character[]
}

model Character {
  id         String        @id @default(uuid())
  userId     String
  name       String
  class      CharacterClass
  level      Int           @default(1)
  experience Int           @default(0)
  health     Int           @default(100)
  maxHealth  Int           @default(100)
  mana       Int           @default(50)
  maxMana    Int           @default(50)
  x          Float         @default(0)
  y          Float         @default(0)
  createdAt  DateTime      @default(now())
  updatedAt  DateTime      @updatedAt
  
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  inventory InventoryItem[]
  
  @@index([userId])
}

enum CharacterClass {
  ASSASSIN
  AMAZON
  BARBARIAN
  GUARDIAN
  WITCH
  SORCERESS
  MAGE
  DRUID
}

model Item {
  id          String   @id @default(uuid())
  name        String
  description String?
  type        ItemType
  rarity      Rarity   @default(COMMON)
  value       Int      @default(0)
  stackable   Boolean  @default(false)
  maxStack    Int      @default(1)
  createdAt   DateTime @default(now())
  
  inventoryItems InventoryItem[]
}

model InventoryItem {
  id          String    @id @default(uuid())
  characterId String
  itemId      String
  quantity    Int       @default(1)
  equipped    Boolean   @default(false)
  createdAt   DateTime  @default(now())
  
  character   Character @relation(fields: [characterId], references: [id], onDelete: Cascade)
  item        Item      @relation(fields: [itemId], references: [id])
  
  @@unique([characterId, itemId])
  @@index([characterId])
}

enum ItemType {
  WEAPON
  ARMOR
  CONSUMABLE
  QUEST
  MATERIAL
}

enum Rarity {
  COMMON
  UNCOMMON
  RARE
  EPIC
  LEGENDARY
}
